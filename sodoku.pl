:- use_module(library(clpfd)).

sudoku(Rows) :-  
    append(Rows, Vs), Vs ins 1..9,
    maplist(all_distinct, Rows),
    transpose(Rows, Columns),     
    maplist(all_distinct, Columns),     
    Rows = [A,B,C,D,E,F,G,H,I],     
    blocks(A, B, C), blocks(D, E, F), blocks(G, H, I),     
    maplist(label, Rows).      

blocks([], [], []).       
blocks([A,B,C|Bs1], [D,E,F|Bs2], [G,H,I|Bs3]) :-     
    all_distinct([A,B,C,D,E,F,G,H,I]),      
    blocks(Bs1, Bs2, Bs3).  

puzzle("bb-1",[[_,6,_,9,2,8,_,_,_],
    [7,8,1,_,_,_,_,_,_],
    [9,_,_,_,_,_,8,3,6],
    [_,4,2,8,1,9,_,_,_],
    [_,7,5,_,_,_,1,8,_],
    [_,_,_,5,7,6,2,4,_],
    [4,5,8,_,_,_,_,_,1],
    [_,_,_,_,_,_,4,9,2],
    [_,_,_,1,4,3,_,7,_]]).

puzzle("bb-2",[[_,_,_,5,_,1,9,_,3],
    [_,5,4,_,_,9,_,_,2],
    [_,9,_,_,2,3,_,_,6],
    [_,_,7,2,4,_,3,_,_],
    [4,_,5,_,_,_,7,_,9],
    [_,_,8,_,9,5,1,_,_],
    [5,_,_,8,6,_,_,3,_],
    [1,_,_,9,_,_,4,5,_],
    [7,_,3,1,_,4,_,_,_]]).

puzzle("bb-3",[[_,_,_,9,_,_,_,_,_],
    [_,6,_,_,5,1,_,_,_],
    [1,_,4,_,_,_,3,_,2],
    [4,_,_,_,_,_,_,_,_],
    [_,_,2,_,_,_,_,_,9],
    [_,_,_,3,_,_,7,2,6],
    [_,_,6,_,1,8,_,_,_],
    [_,_,_,_,_,3,2,_,_],
    [8,7,1,5,_,9,4,_,_]]).

puzzle("bb-4",[[_,_,_,_,_,_,_,_,_],
    [_,_,_,_,_,5,1,9,3],
    [_,_,6,4,_,3,_,_,_],
    [_,_,_,_,_,_,_,_,1],
    [_,_,_,_,_,_,_,8,_],
    [_,1,_,8,_,9,_,7,6],
    [4,9,_,1,_,_,_,3,_],
    [_,_,2,3,_,_,_,_,8],
    [8,_,_,6,_,4,_,5,9]]).

puzzle("bb-5",[[_,_,_,_,2,_,_,7,_],
    [4,_,_,_,1,8,_,_,5],
    [_,7,3,_,_,_,_,_,9],
    [_,_,_,_,_,_,7,_,_],
    [_,_,_,_,8,_,_,1,_],
    [_,_,_,_,_,9,_,_,3],
    [_,9,_,_,_,5,_,_,_],
    [8,_,_,6,_,1,_,3,_],
    [_,_,2,_,_,_,4,_,_]]).

puzzle("ex02-2", [[_,_,_,_,_,_,9,_,7],
    [_,_,_,4,2,_,1,8,_],
    [_,_,_,7,_,5,_,2,6],
    [1,_,_,9,_,4,_,_,_],
    [_,5,_,_,_,_,_,4,_],
    [_,_,_,5,_,7,_,_,9],
    [9,2,_,1,_,8,_,_,_],
    [_,3,4,_,5,9,_,_,_],
    [5,_,7,_,_,_,_,_,_]]).

puzzle("u-1", [[2,3,_,_,_,_,5,_,_],
    [_,_,5,_,_,_,_,_,2],
    [9,4,6,_,_,_,_,_,_],
    [_,6,_,7,4,_,_,_,_],
    [_,_,_,3,8,_,_,5,_],
    [4,_,_,_,5,9,_,_,8],
    [_,_,_,1,_,_,3,7,_],
    [_,_,1,_,6,_,_,4,_],
    [_,8,_,_,_,_,_,_,_]]).

solve(P) :- puzzle(P,X), sudoku(X), print(X).

main :- solve("bb-1").
